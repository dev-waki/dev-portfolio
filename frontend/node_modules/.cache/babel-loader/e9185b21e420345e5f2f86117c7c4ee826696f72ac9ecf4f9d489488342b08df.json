{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra and Zackary Jackson @ScriptedAlchemy\n*/\n\n\"use strict\";\n\nconst {\n  SyncHook\n} = require(\"tapable\");\nconst isValidExternalsType = require(\"../../schemas/plugins/container/ExternalsType.check.js\");\nconst Compilation = require(\"../Compilation\");\nconst SharePlugin = require(\"../sharing/SharePlugin\");\nconst createSchemaValidation = require(\"../util/create-schema-validation\");\nconst ContainerPlugin = require(\"./ContainerPlugin\");\nconst ContainerReferencePlugin = require(\"./ContainerReferencePlugin\");\nconst HoistContainerReferences = require(\"./HoistContainerReferencesPlugin\");\n\n/** @typedef {import(\"../../declarations/plugins/container/ModuleFederationPlugin\").ExternalsType} ExternalsType */\n/** @typedef {import(\"../../declarations/plugins/container/ModuleFederationPlugin\").ModuleFederationPluginOptions} ModuleFederationPluginOptions */\n/** @typedef {import(\"../../declarations/plugins/container/ModuleFederationPlugin\").Shared} Shared */\n/** @typedef {import(\"../Compiler\")} Compiler */\n/** @typedef {import(\"../Dependency\")} Dependency */\n\n/**\n * @typedef {object} CompilationHooks\n * @property {SyncHook<Dependency>} addContainerEntryDependency\n * @property {SyncHook<Dependency>} addFederationRuntimeDependency\n */\n\nconst validate = createSchemaValidation(require(\"../../schemas/plugins/container/ModuleFederationPlugin.check.js\"), () => require(\"../../schemas/plugins/container/ModuleFederationPlugin.json\"), {\n  name: \"Module Federation Plugin\",\n  baseDataPath: \"options\"\n});\n\n/** @type {WeakMap<Compilation, CompilationHooks>} */\nconst compilationHooksMap = new WeakMap();\nclass ModuleFederationPlugin {\n  /**\n   * @param {ModuleFederationPluginOptions} options options\n   */\n  constructor(options) {\n    validate(options);\n    this._options = options;\n  }\n\n  /**\n   * Get the compilation hooks associated with this plugin.\n   * @param {Compilation} compilation The compilation instance.\n   * @returns {CompilationHooks} The hooks for the compilation.\n   */\n  static getCompilationHooks(compilation) {\n    if (!(compilation instanceof Compilation)) {\n      throw new TypeError(\"The 'compilation' argument must be an instance of Compilation\");\n    }\n    let hooks = compilationHooksMap.get(compilation);\n    if (!hooks) {\n      hooks = {\n        addContainerEntryDependency: new SyncHook([\"dependency\"]),\n        addFederationRuntimeDependency: new SyncHook([\"dependency\"])\n      };\n      compilationHooksMap.set(compilation, hooks);\n    }\n    return hooks;\n  }\n\n  /**\n   * Apply the plugin\n   * @param {Compiler} compiler the compiler instance\n   * @returns {void}\n   */\n  apply(compiler) {\n    const {\n      _options: options\n    } = this;\n    const library = options.library || {\n      type: \"var\",\n      name: options.name\n    };\n    const remoteType = options.remoteType || (options.library && isValidExternalsType(options.library.type) ? (/** @type {ExternalsType} */options.library.type) : \"script\");\n    if (library && !compiler.options.output.enabledLibraryTypes.includes(library.type)) {\n      compiler.options.output.enabledLibraryTypes.push(library.type);\n    }\n    compiler.hooks.afterPlugins.tap(\"ModuleFederationPlugin\", () => {\n      if (options.exposes && (Array.isArray(options.exposes) ? options.exposes.length > 0 : Object.keys(options.exposes).length > 0)) {\n        new ContainerPlugin({\n          name: (/** @type {string} */options.name),\n          library,\n          filename: options.filename,\n          runtime: options.runtime,\n          shareScope: options.shareScope,\n          exposes: options.exposes\n        }).apply(compiler);\n      }\n      if (options.remotes && (Array.isArray(options.remotes) ? options.remotes.length > 0 : Object.keys(options.remotes).length > 0)) {\n        new ContainerReferencePlugin({\n          remoteType,\n          shareScope: options.shareScope,\n          remotes: options.remotes\n        }).apply(compiler);\n      }\n      if (options.shared) {\n        new SharePlugin({\n          shared: options.shared,\n          shareScope: options.shareScope\n        }).apply(compiler);\n      }\n      new HoistContainerReferences().apply(compiler);\n    });\n  }\n}\nmodule.exports = ModuleFederationPlugin;","map":{"version":3,"names":["SyncHook","require","isValidExternalsType","Compilation","SharePlugin","createSchemaValidation","ContainerPlugin","ContainerReferencePlugin","HoistContainerReferences","validate","name","baseDataPath","compilationHooksMap","WeakMap","ModuleFederationPlugin","constructor","options","_options","getCompilationHooks","compilation","TypeError","hooks","get","addContainerEntryDependency","addFederationRuntimeDependency","set","apply","compiler","library","type","remoteType","output","enabledLibraryTypes","includes","push","afterPlugins","tap","exposes","Array","isArray","length","Object","keys","filename","runtime","shareScope","remotes","shared","module","exports"],"sources":["/home/wickliff/Desktop/dev-waki/portfolio2/node_modules/webpack/lib/container/ModuleFederationPlugin.js"],"sourcesContent":["/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra and Zackary Jackson @ScriptedAlchemy\n*/\n\n\"use strict\";\n\nconst { SyncHook } = require(\"tapable\");\nconst isValidExternalsType = require(\"../../schemas/plugins/container/ExternalsType.check.js\");\nconst Compilation = require(\"../Compilation\");\nconst SharePlugin = require(\"../sharing/SharePlugin\");\nconst createSchemaValidation = require(\"../util/create-schema-validation\");\nconst ContainerPlugin = require(\"./ContainerPlugin\");\nconst ContainerReferencePlugin = require(\"./ContainerReferencePlugin\");\nconst HoistContainerReferences = require(\"./HoistContainerReferencesPlugin\");\n\n/** @typedef {import(\"../../declarations/plugins/container/ModuleFederationPlugin\").ExternalsType} ExternalsType */\n/** @typedef {import(\"../../declarations/plugins/container/ModuleFederationPlugin\").ModuleFederationPluginOptions} ModuleFederationPluginOptions */\n/** @typedef {import(\"../../declarations/plugins/container/ModuleFederationPlugin\").Shared} Shared */\n/** @typedef {import(\"../Compiler\")} Compiler */\n/** @typedef {import(\"../Dependency\")} Dependency */\n\n/**\n * @typedef {object} CompilationHooks\n * @property {SyncHook<Dependency>} addContainerEntryDependency\n * @property {SyncHook<Dependency>} addFederationRuntimeDependency\n */\n\nconst validate = createSchemaValidation(\n\trequire(\"../../schemas/plugins/container/ModuleFederationPlugin.check.js\"),\n\t() => require(\"../../schemas/plugins/container/ModuleFederationPlugin.json\"),\n\t{\n\t\tname: \"Module Federation Plugin\",\n\t\tbaseDataPath: \"options\"\n\t}\n);\n\n/** @type {WeakMap<Compilation, CompilationHooks>} */\nconst compilationHooksMap = new WeakMap();\n\nclass ModuleFederationPlugin {\n\t/**\n\t * @param {ModuleFederationPluginOptions} options options\n\t */\n\tconstructor(options) {\n\t\tvalidate(options);\n\n\t\tthis._options = options;\n\t}\n\n\t/**\n\t * Get the compilation hooks associated with this plugin.\n\t * @param {Compilation} compilation The compilation instance.\n\t * @returns {CompilationHooks} The hooks for the compilation.\n\t */\n\tstatic getCompilationHooks(compilation) {\n\t\tif (!(compilation instanceof Compilation)) {\n\t\t\tthrow new TypeError(\n\t\t\t\t\"The 'compilation' argument must be an instance of Compilation\"\n\t\t\t);\n\t\t}\n\t\tlet hooks = compilationHooksMap.get(compilation);\n\t\tif (!hooks) {\n\t\t\thooks = {\n\t\t\t\taddContainerEntryDependency: new SyncHook([\"dependency\"]),\n\t\t\t\taddFederationRuntimeDependency: new SyncHook([\"dependency\"])\n\t\t\t};\n\t\t\tcompilationHooksMap.set(compilation, hooks);\n\t\t}\n\t\treturn hooks;\n\t}\n\n\t/**\n\t * Apply the plugin\n\t * @param {Compiler} compiler the compiler instance\n\t * @returns {void}\n\t */\n\tapply(compiler) {\n\t\tconst { _options: options } = this;\n\t\tconst library = options.library || { type: \"var\", name: options.name };\n\t\tconst remoteType =\n\t\t\toptions.remoteType ||\n\t\t\t(options.library && isValidExternalsType(options.library.type)\n\t\t\t\t? /** @type {ExternalsType} */ (options.library.type)\n\t\t\t\t: \"script\");\n\t\tif (\n\t\t\tlibrary &&\n\t\t\t!compiler.options.output.enabledLibraryTypes.includes(library.type)\n\t\t) {\n\t\t\tcompiler.options.output.enabledLibraryTypes.push(library.type);\n\t\t}\n\t\tcompiler.hooks.afterPlugins.tap(\"ModuleFederationPlugin\", () => {\n\t\t\tif (\n\t\t\t\toptions.exposes &&\n\t\t\t\t(Array.isArray(options.exposes)\n\t\t\t\t\t? options.exposes.length > 0\n\t\t\t\t\t: Object.keys(options.exposes).length > 0)\n\t\t\t) {\n\t\t\t\tnew ContainerPlugin({\n\t\t\t\t\tname: /** @type {string} */ (options.name),\n\t\t\t\t\tlibrary,\n\t\t\t\t\tfilename: options.filename,\n\t\t\t\t\truntime: options.runtime,\n\t\t\t\t\tshareScope: options.shareScope,\n\t\t\t\t\texposes: options.exposes\n\t\t\t\t}).apply(compiler);\n\t\t\t}\n\t\t\tif (\n\t\t\t\toptions.remotes &&\n\t\t\t\t(Array.isArray(options.remotes)\n\t\t\t\t\t? options.remotes.length > 0\n\t\t\t\t\t: Object.keys(options.remotes).length > 0)\n\t\t\t) {\n\t\t\t\tnew ContainerReferencePlugin({\n\t\t\t\t\tremoteType,\n\t\t\t\t\tshareScope: options.shareScope,\n\t\t\t\t\tremotes: options.remotes\n\t\t\t\t}).apply(compiler);\n\t\t\t}\n\t\t\tif (options.shared) {\n\t\t\t\tnew SharePlugin({\n\t\t\t\t\tshared: options.shared,\n\t\t\t\t\tshareScope: options.shareScope\n\t\t\t\t}).apply(compiler);\n\t\t\t}\n\t\t\tnew HoistContainerReferences().apply(compiler);\n\t\t});\n\t}\n}\n\nmodule.exports = ModuleFederationPlugin;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}